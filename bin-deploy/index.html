<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>Classbook</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <script type="text/javascript" src="swfobject/swfobject.js"></script>
    <script type="text/javascript" src="js/kalki/utils.js"></script>
    
    <script type="text/javascript">
			var flashvars = {
            				 graphAPIUrl: "https://graph.facebook.com/"
							};
			var params = {
			    allowScriptAccess: "sameDomain"
			};
			
			var attributes = {
			    id: "FacebookOAuthGraphTest",
			    name: "FacebookOAuthGraphTest"
			};
			flashvars = kalki.mixinQueryParams(flashvars);

			swfobject.embedSWF(
				"Container.swf", 
				"Container", 
				"460", 
				"460", 
				"10.0.0.0",
				"swfobject/expressInstall.swf",
				flashvars,
				params,
				attributes);
    </script>
    <script type="text/javascript">
        //<![CDATA[
        function getRequestParameter(name)
        {
            name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
            var results = regex.exec(window.location.href);
            return results == null ? "" : results[1];
        }

        function allRequestParameters()
        {
            var data = {};
            var strHref = window.location.href;
            if ( strHref.indexOf("?") > -1 ) {
                var strQueryString = strHref.substr(strHref.indexOf("?")+1);
                var aQueryString = strQueryString.split("&");
                for ( var iParam = 0; iParam < aQueryString.length; iParam++ ) {
                    var aParam = aQueryString[iParam].split("=");
                    data[aParam[0]] = aParam[1];
                }
            }
            return data;
        }

        function generateFlash()
        {
            var flashvars = allRequestParameters();
            var params = {
                allowScriptAccess: "sameDomain"
            };
 
            var attributes = {
                id: "FacebookOAuthGraphTest",
                name: "FacebookOAuthGraphTest"
            };
            swfobject.embedSWF("FacebookOAuthGraphTest.swf?v=2", "alternative", "100%", "100%", "10.0.0",
                "expressInstall.swf", flashvars, params, attributes);
        }
        if(!getRequestParameter("session")){
            window.top.location = "https://graph.facebook.com/oauth/authorize"
                + "?client_id=" + '268718683475'
                + "&redirect_uri=" + 'http://apps.facebook.com/blogoauthgraph/'
                + "&scope=publish_stream,user_photos,user_photo_video_tags"
        }else{
            generateFlash();
        }
        //]]>
    </script>
	<style type="text/css" media="screen">
	  html, body, #containerA, #containerB { height:100%; }
	  body { margin:0; padding:0; overflow:hidden; }
	</style>
  </head>
  <body>
    <div id="Container">
      <p>You need atleast Flash Player 10.0.0.0 to view this content.
			<a href="http://www.adobe.com/go/getflashplayer">Get Flash Player</a></p>
    </div>
  </body>
</html>